# =============================================================================
# AI CONTEXT: truck_number Block
# Workspace: Actions
# =============================================================================

block_name: "truck_number"
block_type: leaf
workspace: actions

# -----------------------------------------------------------------------------
# CORE INTENT
# -----------------------------------------------------------------------------
intent: |
  Represents the truck_number state variable, a commonly used field in freight
  and logistics flows for tracking whether the truck identification number has
  been collected and validated.

description: |
  The truck_number block is a specific instance of a state block that tracks
  the truck identification number collection status. This is one of the most
  common data points collected in driver check-in and access control flows.
  
  Key behaviors:
  - Declares truck_number_filled state variable initialized to False
  - Used in Pre-Conditions List to check if truck number needs collection
  - Updated in post_effects when truck number is successfully collected
  - Often paired with trailer_number in freight operations
  
  Related state variables:
  - truck_number_filled: Boolean tracking if number was collected
  - truck_number_validated: Boolean tracking if format/registry validated
  - truck_number_timeout: Boolean tracking collection timeout

# -----------------------------------------------------------------------------
# SEMANTIC ROLE
# -----------------------------------------------------------------------------
semantic_role: data_collection

# -----------------------------------------------------------------------------
# FIELD DEFINITIONS
# -----------------------------------------------------------------------------
fields:
  init:
    intent: "Initializes the truck_number state variable with its starting value"
    description: |
      The init field contains the state variable declaration in format:
      truck_number_filled: False
      
      This declares that the truck number has not yet been collected.
      After successful collection, post_effects set this to True.
    value_type: "state_initialization"
    required: true
    default_behavior: |
      Should be initialized to False since truck number starts as uncollected.
    examples:
      - "truck_number_filled: False"
      - "truck_number_validated: False"
      - "truck_number_timeout: False"

# -----------------------------------------------------------------------------
# STRUCTURAL CONSTRAINTS
# -----------------------------------------------------------------------------
allowed_children: []  # Leaf block - no children

required_children:
  min: 0
  max: 0
  types: []

allowed_parents:
  - State List  # truck_number can only exist inside State List

# -----------------------------------------------------------------------------
# RESTRICTIONS & RULES
# -----------------------------------------------------------------------------
restrictions:
  - "truck_number blocks can ONLY exist as direct children of State List"
  - "Should always be initialized to False (uncollected state)"
  - "Must be referenced in Pre-Conditions List or post_effects to be useful"
  - "Use truck_number_filled for collection status, truck_number_validated for validation status"

# -----------------------------------------------------------------------------
# RELATIONSHIPS
# -----------------------------------------------------------------------------
relationships:
  requires:
    - State List  # Must have a State List parent
  
  pairs_with:
    - Pre-Condition  # States are checked in pre-conditions
    - Post Effect    # States are updated in post-effects
    - field          # Often paired with a field block collecting the actual number
  
  typically_preceded_by: null  # Order in State List is flexible
  
  typically_followed_by:
    - trailer_number  # Often followed by trailer number in freight flows

# -----------------------------------------------------------------------------
# USAGE EXAMPLES
# -----------------------------------------------------------------------------
examples:
  - name: "Basic truck_number State"
    description: "Simple declaration of truck_number_filled state"
    yaml: |
      state:
        - truck_number_filled: False

  - name: "In State List"
    description: "truck_number within a State List container"
    yaml: |
      State List:
        - state:
            - truck_number_filled: False

  - name: "With Related States"
    description: "truck_number with validation and timeout states"
    yaml: |
      State List:
        - state:
            - truck_number_filled: False
        - state:
            - truck_number_validated: False
        - state:
            - collect_truck_num_v1_timeout: False

  - name: "Complete Card with truck_number"
    description: "Card that collects truck number with state tracking"
    yaml: |
      Card:
        - card_id: collect_truck_num_v1
        - State List:
            - state:
                - truck_number_filled: False
        - delivery:
            - intent:
                - intent: collect
            - interaction:
                - interaction_type: input.text
                - field:
                    - field: truck_number
                    - label: Truck Number
                    - prompt: Please enter your truck number
        - Policy:
            - Timeout:
                - timeout_sec: "30"
        - Pre-Conditions List:
            - Pre-Condition:
                - pre_condition: state.truck_number_filled == False
        - post_effects:
            - Post Effect:
                - post_effect: state.truck_number_filled = True

  - name: "Sequential Dependency"
    description: "Another card waiting for truck_number to be filled"
    yaml: |
      Card:
        - card_id: collect_trailer_num_v1
        - State List:
            - state:
                - truck_number_filled: False
            - state:
                - trailer_number_filled: False
        - Pre-Conditions List:
            - Pre-Condition:
                - pre_condition: state.truck_number_filled == True
            - Pre-Condition:
                - pre_condition: state.trailer_number_filled == False
        - post_effects:
            - Post Effect:
                - post_effect: state.trailer_number_filled = True

# -----------------------------------------------------------------------------
# COMMON MISTAKES
# -----------------------------------------------------------------------------
common_mistakes:
  - mistake: "Using 'truck_number' instead of 'truck_number_filled'"
    correction: "State variables should indicate status, not the data itself"
    example_wrong: |
      state:
        - truck_number: False  # Confusing - is this the number or status?
    example_correct: |
      state:
        - truck_number_filled: False  # Clear - tracks if number was collected

  - mistake: "Initializing to True"
    correction: "State starts as False since data hasn't been collected yet"
    example_wrong: |
      state:
        - truck_number_filled: True  # Wrong initial state
    example_correct: |
      state:
        - truck_number_filled: False  # Correct - starts uncollected

  - mistake: "Not including in post_effects"
    correction: "If you check a state in Pre-Conditions List, update it in post_effects"
    example_wrong: |
      Card:
        - Pre-Conditions List:
            - Pre-Condition:
                - pre_condition: state.truck_number_filled == False
        # Missing post_effects to set truck_number_filled = True!
    example_correct: |
      Card:
        - Pre-Conditions List:
            - Pre-Condition:
                - pre_condition: state.truck_number_filled == False
        - post_effects:
            - Post Effect:
                - post_effect: state.truck_number_filled = True

# -----------------------------------------------------------------------------
# GENERATION HINTS
# -----------------------------------------------------------------------------
generation_hints:
  use_when:
    - "Collecting truck identification number"
    - "Creating driver check-in flow"
    - "Tracking freight vehicle entry"
    - "Sequential data collection starting with truck info"
  
  do_not_use_when:
    - "Flow doesn't involve truck/vehicle identification"
    - "Using a different vehicle identification scheme"
  
  keywords:
    - "truck number"
    - "truck ID"
    - "vehicle number"
    - "truck identification"
    - "check-in"
    - "freight"
    - "driver arrival"

# -----------------------------------------------------------------------------
# DATA CONTEXT
# -----------------------------------------------------------------------------
data_context: |
  The truck_number is typically:
  - A unique identifier for the truck/tractor unit
  - Often displayed on the side of the cab
  - Used for tracking, scheduling, and access control
  - May be validated against a registry or expected arrivals list
  
  Common formats:
  - Alphanumeric (e.g., "TRK-12345", "ABC123")
  - Numeric only (e.g., "54321")
  - Company-specific patterns
  
  Related data points often collected together:
  - truck_number → trailer_number → driver_name → appointment_number
